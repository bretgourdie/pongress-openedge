ROUTINE-LEVEL ON ERROR UNDO, THROW.

USING lib.Input.InputSource.
USING lib.TheField.

CLASS lib.Input.UserInputSource INHERITS InputSource:

  DEF PRIVATE PROPERTY UpArrow AS INT NO-UNDO
    GET:
      RETURN 501.
    END GET.

  DEF PRIVATE PROPERTY DownArrow AS INT NO-UNDO
    GET:
      RETURN 502.
    END GET.

  DEF PRIVATE PROPERTY RightArrow AS INT NO-UNDO
    GET:
      RETURN 503.
    END GET.

  DEF PRIVATE PROPERTY LeftArrow AS INT NO-UNDO
    GET:
      RETURN 504.
    END GET.

  DEF PRIVATE PROPERTY Spacebar AS INT NO-UNDO
    GET:
      RETURN 32.
    END GET.
  
  CONSTRUCTOR PUBLIC UserInputSource():
    SUPER().
  END CONSTRUCTOR.

  METHOD OVERRIDE PUBLIC INT HandleInput(pTheField AS TheField):
    READKEY PAUSE 0.

    CASE LASTKEY:
      WHEN UpArrow THEN RETURN moveUp().
      WHEN DownArrow THEN RETURN moveDown().
      OTHERWISE RETURN otherPresses().
    END CASE.
    
  END METHOD.

  METHOD PRIVATE INT moveUp():
    RETURN -1.
  END METHOD.

  METHOD PRIVATE INT moveDown():
    RETURN 1.
  END METHOD.

  METHOD PRIVATE INT otherPresses():
    RETURN 0.
  END METHOD.
END CLASS.
